!function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=0)}([function(e,t,a){"use strict";function n(e){let t=e+"";return t.length<2&&(t="0"+t),t}function r(e,t=1,a=10){const r=function(e,t,a){const n=t*a,r=n-a;return e.slice(r,n)}(e,t,a);$("#data tbody").empty(),$(r).each((e,t)=>{const a=function(e){return`${("0"+(e=new Date(e)).getDate()).slice(-2)}.${("0"+(e.getMonth()+1)).slice(-2)}.${(""+e.getFullYear()).slice(-2)} ${("0"+e.getHours()).slice(-2)}:${("0"+e.getMinutes()).slice(-2)}`}(t.date),r=`<label>${n(Math.floor(t.duration/60))}</label>:<label>${n(Math.ceil(t.duration%60))}</label>`,i=`<audio class="player" src="${t.audioName}" type="audio/wav"></audio><div class="audio"><button class="play"><i class="fas fa-play-circle"></i></button><label class="minutes">00</label>:<label class="seconds">00</label><div class="myProgress"><div class="myBar"></div></div>${r}<form method="get" action="${t.audioName}"><button type="submit"><i class="fas fa-download"></i></button></form></div>`,o=`<td>${a}</td><td>${t.from}</td><td>${i}</td>`;$("#data tbody").append(`<tr>${o}</tr>`)}),function(e,t){$(".pages").empty();for(let a=1;a<=Math.ceil(e/t);a++)$(".pages").append(`<a href="#" class="page">${a}</a>`)}(e.length,a)}function i(e,t){let a=e;return 0!=t.period&&(a=function(e,t){let a=[];const n=new Date,r=new Date(n.getFullYear(),n.getMonth(),n.getDate()).valueOf(),i=n.getFullYear();switch(+t){case 0:a=e;break;case 1:a=e.filter(e=>{let t=new Date(e.date);return(t=new Date(t.getFullYear(),t.getMonth(),t.getDate()).valueOf())==r});break;case 2:const o=r-864e5;a=e.filter(e=>{let t=new Date(e.date);return(t=new Date(t.getFullYear(),t.getMonth(),t.getDate()).valueOf())==o});break;case 3:const l=r-6048e5;a=e.filter(e=>{let t=new Date(e.date);return(t=new Date(t.getFullYear(),t.getMonth(),t.getDate()).valueOf())>l});break;case 4:const c=n.getMonth()+1;a=e.filter(e=>{const t=new Date(e.date),a=t.getMonth()+1,n=t.getFullYear();return a==c&&n==i});break;case 5:const s=n.getMonth();a=e.filter(e=>{const t=new Date(e.date),a=t.getMonth()+1,n=t.getFullYear();return a==s&&n==i});break;default:console.log("Ошибка в фильтре по дате!")}return a}(a,t.period)),0!=t.duration&&(a=function(e,t){let a;switch(+t){case 0:return e;case 1:a=60;break;case 2:a=180;break;case 3:a=300;break;case 4:a=600;break;default:console.log("Ошибка в фильтре по длительности!")}return e.filter(e=>e.duration<a)}(a,t.duration)),r(a=function(e){const t=$("#search input").val().toUpperCase();return e.filter(e=>e.from.toUpperCase().indexOf(t)>-1)}(a)),a}a.r(t),$(document).ready(()=>{const e=[];let t,a=1,o=[],l={period:0,duration:0};(async function(){const e=$.ajax({type:"POST",url:"data.xml",dataType:"xml",success:()=>{console.log("Данные получены!")},error:function(){alert("ERROR")}});return await e})().then(t=>{$(t).find("Data").each(function(t,a){e[t]={},e[t].id=t,e[t].date=$(this).find("Received").html(),e[t].from=$(this).find("From").html(),e[t].audioName=$(this).find("MIME").find("MIME").attr("Disposition-filename"),e[t].duration=$(this).find("Duration").html()}),r(e,a,10),o=e}).catch(e=>console.error("Error:",e)),$(".pages").on("click",".page",function(){a=$(this).text(),r(o,a,10)}),$(".prevPage button").on("click",()=>{1!=a&&a--,r(o,a,10)}),$(".nextPage button").on("click",()=>{a!=Math.ceil(o.length/10)&&a++,r(o,a,10)}),$("#period").on("change",()=>{l.period=$("#period option:selected").val(),o=i(e,l)}),$("#duration").on("change",()=>{l.duration=$("#duration option:selected").val(),o=i(e,l)}),$("#search").on("input",()=>{$("#search i").css("display","none"),o=i(e,l)}),$("#search").on("change",()=>{""==$("#search input").val()&&$("#search i").css("display","")}),$("#discard").on("click",()=>{l={period:0,duration:0},$("#period").val(0),$("#search input").val(""),$("#duration").val(0),o=i(e,l)}),$("#data").on("click",".audio button",function(e){const a=$(this).parent("div"),r=a.siblings("audio"),i=a.find(".seconds"),o=a.find(".minutes"),l=a.find(".myBar"),c=100/Math.ceil(r[0].duration);r[0].paused?($(this).find("i").removeClass("fa-play-circle"),$(this).find("i").addClass("fa-pause-circle"),r[0].play(),t=setInterval(function(){const e=r[0].currentTime;i[0].innerHTML=n(Math.ceil(e%60)),o[0].innerHTML=n(Math.floor(e/60));const s=Math.ceil(e)*c;$(l).css("width",s+"%"),r[0].ended&&(clearInterval(t),$(a).find(".play i").removeClass("fa-pause-circle"),$(a).find(".play i").addClass("fa-play-circle"))},1e3)):($(this).find("i").removeClass("fa-pause-circle"),$(this).find("i").addClass("fa-play-circle"),r[0].pause(),clearInterval(t))})})}]);